<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Directory Upload</title>
</head>
<body>
  <input type="file" id="uploadFile" accept="image/*" webkitdirectory>
  <button onclick="uploadFile()">Upload</button>
</body>
<script>
  const uploadFileEle = document.querySelector("#uploadFile");

  async function uploadFile() {
      if (!uploadFileEle.files.length) {
          alert("请选择上传文件")
          return
      };
      console.log(uploadFileEle.files);
      const files = Array.from(uploadFileEle.files); // 获取所有文件
      // 省略文件的校验过程，比如文件类型、大小校验
      upload({ url: "/upload/directory", files });
  }

  function upload({ url, files, fieldName = "file" }) {
    let formData = new FormData();
    files.forEach((file) => {
      formData.append(fieldName, file, file.webkitRelativePath.replace(/\//g, "@"));
    });
    fetch(`http://localhost:3000${url}`, {
        method: "POST",
        body: formData
      })
      .then(res => res.json())
      .then(res => {
          console.log(res);
      })
    }
</script>
</html>